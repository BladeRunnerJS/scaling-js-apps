<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Exercise: Messages Blade &amp; Services | How to Build Front-End Web Apps that Scale</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="BladeRunnerJS">
        <meta name="description" content="![How to Build Front-End Web Apps that Scale](./img/apps-that-scale.jpg)">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../services/usercard_services.html" />
        
        
        <link rel="prev" href="../services/input_services.html" />
        

        <meta property="og:title" content="Exercise: Messages Blade &amp; Services | How to Build Front-End Web Apps that Scale">
        <meta property="og:site_name" content="How to Build Front-End Web Apps that Scale">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/BladeRunnerJS">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="BladeRunnerJS/scaling-js-apps" data-level="6.14" data-basepath=".." data-revision="1398931295672">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/BladeRunnerJS/scaling-js-apps" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/BladeRunnerJS/scaling-js-apps/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/BladeRunnerJS/scaling-js-apps/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >How to Build Front-End Web Apps that Scale</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/BladeRunnerJS" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/BladeRunnerJS/scaling-js-apps/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/BladeRunnerJS/scaling-js-apps/edit/master/services/messages_services.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="overview/README.html">
                
                <a href="../overview/README.html">
                    <i class="fa fa-check"></i> <b>1.</b> Workshop Overview
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="overview/who.html">
                            
                            <a href="../overview/who.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> Who are we?
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="overview/schedule.html">
                            
                            <a href="../overview/schedule.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> Schedule
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="overview/learn.html">
                            
                            <a href="../overview/learn.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> What we&#39;re going to learn
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="overview/build.html">
                            
                            <a href="../overview/build.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> What we&#39;re going to build
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="overview/teams.html">
                            
                            <a href="../overview/teams.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> Organisations &amp; Teams
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.6" data-path="overview/prerequisites.html">
                            
                            <a href="../overview/prerequisites.html">
                                <i class="fa fa-check"></i> <b>1.6.</b> Prerequisites
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.7" data-path="overview/heads_up.html">
                            
                            <a href="../overview/heads_up.html">
                                <i class="fa fa-check"></i> <b>1.7.</b> Heads Up!
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="knockout/README.html">
                
                <a href="../knockout/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> KnockoutJS
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="knockout/exercises.html">
                            
                            <a href="../knockout/exercises.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Exercise: KnockoutJS
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="background/README.html">
                
                <a href="../background/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Background
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="background/large_scale.html">
                            
                            <a href="../background/large_scale.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> What is a Large Scale Front-End App?
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="background/large_codebase.html">
                            
                            <a href="../background/large_codebase.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Large Codebase
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="background/ct_codebase.html">
                            
                            <a href="../background/ct_codebase.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Example Large Codebase
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="background/complexity.html">
                            
                            <a href="../background/complexity.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> Complexity
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="background/gmail.html">
                            
                            <a href="../background/gmail.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> Gmail
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.6" data-path="background/caplin_trader.html">
                            
                            <a href="../background/caplin_trader.html">
                                <i class="fa fa-check"></i> <b>3.6.</b> Caplin Trader
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.7" data-path="background/large_spa.html">
                            
                            <a href="../background/large_spa.html">
                                <i class="fa fa-check"></i> <b>3.7.</b> Large SPAs
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.8" data-path="background/contributors.html">
                            
                            <a href="../background/contributors.html">
                                <i class="fa fa-check"></i> <b>3.8.</b> Contributors
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.9" data-path="background/who_contributes.html">
                            
                            <a href="../background/who_contributes.html">
                                <i class="fa fa-check"></i> <b>3.9.</b> Who Contributes?
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.10" data-path="background/questions.html">
                            
                            <a href="../background/questions.html">
                                <i class="fa fa-check"></i> <b>3.10.</b> Lots of Questions?
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.11" data-path="background/approach.html">
                            
                            <a href="../background/approach.html">
                                <i class="fa fa-check"></i> <b>3.11.</b> Workshop Approach
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="blades/README.html">
                
                <a href="../blades/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Features/Blades
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="blades/overview.html">
                            
                            <a href="../blades/overview.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> Overview
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="blades/problems_solved.html">
                            
                            <a href="../blades/problems_solved.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> Problems Solved
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="blades/find_code.html">
                            
                            <a href="../blades/find_code.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> Where&#39;s the Code?
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.4" data-path="blades/broken_app.html">
                            
                            <a href="../blades/broken_app.html">
                                <i class="fa fa-check"></i> <b>4.4.</b> Who Broke the App?
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.5" data-path="blades/f5_compile.html">
                            
                            <a href="../blades/f5_compile.html">
                                <i class="fa fa-check"></i> <b>4.5.</b> F5 is the New Compile
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.6" data-path="blades/exercises.html">
                            
                            <a href="../blades/exercises.html">
                                <i class="fa fa-check"></i> <b>4.6.</b> Exercises
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.7" data-path="blades/input_blade.html">
                            
                            <a href="../blades/input_blade.html">
                                <i class="fa fa-check"></i> <b>4.7.</b> Exercise: Input
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.8" data-path="blades/messages_blade.html">
                            
                            <a href="../blades/messages_blade.html">
                                <i class="fa fa-check"></i> <b>4.8.</b> Exercise: Messages
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.9" data-path="blades/usercard_blade.html">
                            
                            <a href="../blades/usercard_blade.html">
                                <i class="fa fa-check"></i> <b>4.9.</b> Exercise: User Card
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.10" data-path="blades/retrospective.html">
                            
                            <a href="../blades/retrospective.html">
                                <i class="fa fa-check"></i> <b>4.10.</b> Retrospective
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="aspects/README.html">
                
                <a href="../aspects/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Apps &amp; Aspects
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="aspects/exercise.html">
                            
                            <a href="../aspects/exercise.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Composing Blades into Aspects
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.2" data-path="aspects/retrospective.html">
                            
                            <a href="../aspects/retrospective.html">
                                <i class="fa fa-check"></i> <b>5.2.</b> Retrospective
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="6" data-path="services/README.html">
                
                <a href="../services/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> Services &amp; the ServiceRegistry
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="6.1" data-path="services/services.html">
                            
                            <a href="../services/services.html">
                                <i class="fa fa-check"></i> <b>6.1.</b> Services
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.2" data-path="services/service_registry.html">
                            
                            <a href="../services/service_registry.html">
                                <i class="fa fa-check"></i> <b>6.2.</b> ServiceRegistry
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.3" data-path="services/problems_solved.html">
                            
                            <a href="../services/problems_solved.html">
                                <i class="fa fa-check"></i> <b>6.3.</b> Problems Solved
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.4" data-path="services/dev_dependencies.html">
                            
                            <a href="../services/dev_dependencies.html">
                                <i class="fa fa-check"></i> <b>6.4.</b> Developer Environment Dependencies
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.5" data-path="services/required_dependencies.html">
                            
                            <a href="../services/required_dependencies.html">
                                <i class="fa fa-check"></i> <b>6.5.</b> Required Dependencies
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.6" data-path="services/no_dependencies.html">
                            
                            <a href="../services/no_dependencies.html">
                                <i class="fa fa-check"></i> <b>6.6.</b> No Backend Dependencies
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.7" data-path="services/configuring_services.html">
                            
                            <a href="../services/configuring_services.html">
                                <i class="fa fa-check"></i> <b>6.7.</b> Configuring Services
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.8" data-path="services/workbenches.html">
                            
                            <a href="../services/workbenches.html">
                                <i class="fa fa-check"></i> <b>6.8.</b> Workbenches
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.9" data-path="services/modularapp_services.html">
                            
                            <a href="../services/modularapp_services.html">
                                <i class="fa fa-check"></i> <b>6.9.</b> Modular App Services
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.10" data-path="services/user_service.html">
                            
                            <a href="../services/user_service.html">
                                <i class="fa fa-check"></i> <b>6.10.</b> User Service
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.11" data-path="services/chat_service.html">
                            
                            <a href="../services/chat_service.html">
                                <i class="fa fa-check"></i> <b>6.11.</b> Chat Service
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.12" data-path="services/exercises_overview.html">
                            
                            <a href="../services/exercises_overview.html">
                                <i class="fa fa-check"></i> <b>6.12.</b> Exercises Overview
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.13" data-path="services/input_services.html">
                            
                            <a href="../services/input_services.html">
                                <i class="fa fa-check"></i> <b>6.13.</b> Exercise: Input Blade &amp; Services
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.14" data-path="services/messages_services.html">
                            
                            <a href="../services/messages_services.html">
                                <i class="fa fa-check"></i> <b>6.14.</b> Exercise: Messages Blade &amp; Services
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.15" data-path="services/usercard_services.html">
                            
                            <a href="../services/usercard_services.html">
                                <i class="fa fa-check"></i> <b>6.15.</b> Exercise: User Card Blade &amp; Services
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.16" data-path="services/retrospective.html">
                            
                            <a href="../services/retrospective.html">
                                <i class="fa fa-check"></i> <b>6.16.</b> Retrospective
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="7" data-path="aspects_services/README.html">
                
                <a href="../aspects_services/README.html">
                    <i class="fa fa-check"></i> <b>7.</b> Apps &amp; Aspects (again)
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="7.1" data-path="aspects_services/retrospective.html">
                            
                            <a href="../aspects_services/retrospective.html">
                                <i class="fa fa-check"></i> <b>7.1.</b> Retrospective
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="8" data-path="extras/README.html">
                
                <a href="../extras/README.html">
                    <i class="fa fa-check"></i> <b>8.</b> Extras
                </a>
                
                
            </li>
        
            <li  data-level="9" >
                
                <span><b>9.</b> Reference</span>
                
                
                <ul class="articles">
                    
                        <li  data-level="9.1" data-path="reference/dev_setup.html">
                            
                            <a href="../reference/dev_setup.html">
                                <i class="fa fa-check"></i> <b>9.1.</b> Suggested Dev Setup
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.2" data-path="reference/faq_gotchas.html">
                            
                            <a href="../reference/faq_gotchas.html">
                                <i class="fa fa-check"></i> <b>9.2.</b> FAQ &amp; Gotchas
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 74.13793103448276%;min-width: 72.41379310344827%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../overview/README.html" title="Workshop Overview" class="chapter done new-chapter" data-progress="1" style="left: 1.7241379310344827%;"></a>
    
        <a href="../overview/who.html" title="Who are we?" class="chapter done " data-progress="1.1" style="left: 3.4482758620689653%;"></a>
    
        <a href="../overview/schedule.html" title="Schedule" class="chapter done " data-progress="1.2" style="left: 5.172413793103448%;"></a>
    
        <a href="../overview/learn.html" title="What we&#39;re going to learn" class="chapter done " data-progress="1.3" style="left: 6.896551724137931%;"></a>
    
        <a href="../overview/build.html" title="What we&#39;re going to build" class="chapter done " data-progress="1.4" style="left: 8.620689655172415%;"></a>
    
        <a href="../overview/teams.html" title="Organisations &amp; Teams" class="chapter done " data-progress="1.5" style="left: 10.344827586206897%;"></a>
    
        <a href="../overview/prerequisites.html" title="Prerequisites" class="chapter done " data-progress="1.6" style="left: 12.068965517241379%;"></a>
    
        <a href="../overview/heads_up.html" title="Heads Up!" class="chapter done " data-progress="1.7" style="left: 13.793103448275861%;"></a>
    
        <a href="../knockout/README.html" title="KnockoutJS" class="chapter done new-chapter" data-progress="2" style="left: 15.517241379310345%;"></a>
    
        <a href="../knockout/exercises.html" title="Exercise: KnockoutJS" class="chapter done " data-progress="2.1" style="left: 17.24137931034483%;"></a>
    
        <a href="../background/README.html" title="Background" class="chapter done new-chapter" data-progress="3" style="left: 18.96551724137931%;"></a>
    
        <a href="../background/large_scale.html" title="What is a Large Scale Front-End App?" class="chapter done " data-progress="3.1" style="left: 20.689655172413794%;"></a>
    
        <a href="../background/questions.html" title="Lots of Questions?" class="chapter done " data-progress="3.10" style="left: 22.413793103448278%;"></a>
    
        <a href="../background/approach.html" title="Workshop Approach" class="chapter done " data-progress="3.11" style="left: 24.137931034482758%;"></a>
    
        <a href="../background/large_codebase.html" title="Large Codebase" class="chapter done " data-progress="3.2" style="left: 25.862068965517242%;"></a>
    
        <a href="../background/ct_codebase.html" title="Example Large Codebase" class="chapter done " data-progress="3.3" style="left: 27.586206896551722%;"></a>
    
        <a href="../background/complexity.html" title="Complexity" class="chapter done " data-progress="3.4" style="left: 29.310344827586206%;"></a>
    
        <a href="../background/gmail.html" title="Gmail" class="chapter done " data-progress="3.5" style="left: 31.03448275862069%;"></a>
    
        <a href="../background/caplin_trader.html" title="Caplin Trader" class="chapter done " data-progress="3.6" style="left: 32.758620689655174%;"></a>
    
        <a href="../background/large_spa.html" title="Large SPAs" class="chapter done " data-progress="3.7" style="left: 34.48275862068966%;"></a>
    
        <a href="../background/contributors.html" title="Contributors" class="chapter done " data-progress="3.8" style="left: 36.206896551724135%;"></a>
    
        <a href="../background/who_contributes.html" title="Who Contributes?" class="chapter done " data-progress="3.9" style="left: 37.93103448275862%;"></a>
    
        <a href="../blades/README.html" title="Features/Blades" class="chapter done new-chapter" data-progress="4" style="left: 39.6551724137931%;"></a>
    
        <a href="../blades/overview.html" title="Overview" class="chapter done " data-progress="4.1" style="left: 41.37931034482759%;"></a>
    
        <a href="../blades/retrospective.html" title="Retrospective" class="chapter done " data-progress="4.10" style="left: 43.10344827586207%;"></a>
    
        <a href="../blades/problems_solved.html" title="Problems Solved" class="chapter done " data-progress="4.2" style="left: 44.827586206896555%;"></a>
    
        <a href="../blades/find_code.html" title="Where&#39;s the Code?" class="chapter done " data-progress="4.3" style="left: 46.55172413793103%;"></a>
    
        <a href="../blades/broken_app.html" title="Who Broke the App?" class="chapter done " data-progress="4.4" style="left: 48.275862068965516%;"></a>
    
        <a href="../blades/f5_compile.html" title="F5 is the New Compile" class="chapter done " data-progress="4.5" style="left: 50%;"></a>
    
        <a href="../blades/exercises.html" title="Exercises" class="chapter done " data-progress="4.6" style="left: 51.724137931034484%;"></a>
    
        <a href="../blades/input_blade.html" title="Exercise: Input" class="chapter done " data-progress="4.7" style="left: 53.44827586206897%;"></a>
    
        <a href="../blades/messages_blade.html" title="Exercise: Messages" class="chapter done " data-progress="4.8" style="left: 55.172413793103445%;"></a>
    
        <a href="../blades/usercard_blade.html" title="Exercise: User Card" class="chapter done " data-progress="4.9" style="left: 56.89655172413793%;"></a>
    
        <a href="../aspects/README.html" title="Apps &amp; Aspects" class="chapter done new-chapter" data-progress="5" style="left: 58.62068965517241%;"></a>
    
        <a href="../aspects/exercise.html" title="Composing Blades into Aspects" class="chapter done " data-progress="5.1" style="left: 60.3448275862069%;"></a>
    
        <a href="../aspects/retrospective.html" title="Retrospective" class="chapter done " data-progress="5.2" style="left: 62.06896551724138%;"></a>
    
        <a href="../services/README.html" title="Services &amp; the ServiceRegistry" class="chapter done new-chapter" data-progress="6" style="left: 63.793103448275865%;"></a>
    
        <a href="../services/services.html" title="Services" class="chapter done " data-progress="6.1" style="left: 65.51724137931035%;"></a>
    
        <a href="../services/user_service.html" title="User Service" class="chapter done " data-progress="6.10" style="left: 67.24137931034483%;"></a>
    
        <a href="../services/chat_service.html" title="Chat Service" class="chapter done " data-progress="6.11" style="left: 68.96551724137932%;"></a>
    
        <a href="../services/exercises_overview.html" title="Exercises Overview" class="chapter done " data-progress="6.12" style="left: 70.6896551724138%;"></a>
    
        <a href="../services/input_services.html" title="Exercise: Input Blade &amp; Services" class="chapter done " data-progress="6.13" style="left: 72.41379310344827%;"></a>
    
        <a href="../services/messages_services.html" title="Exercise: Messages Blade &amp; Services" class="chapter done " data-progress="6.14" style="left: 74.13793103448276%;"></a>
    
        <a href="../services/usercard_services.html" title="Exercise: User Card Blade &amp; Services" class="chapter  " data-progress="6.15" style="left: 75.86206896551724%;"></a>
    
        <a href="../services/retrospective.html" title="Retrospective" class="chapter  " data-progress="6.16" style="left: 77.58620689655173%;"></a>
    
        <a href="../services/service_registry.html" title="ServiceRegistry" class="chapter  " data-progress="6.2" style="left: 79.3103448275862%;"></a>
    
        <a href="../services/problems_solved.html" title="Problems Solved" class="chapter  " data-progress="6.3" style="left: 81.03448275862068%;"></a>
    
        <a href="../services/dev_dependencies.html" title="Developer Environment Dependencies" class="chapter  " data-progress="6.4" style="left: 82.75862068965517%;"></a>
    
        <a href="../services/required_dependencies.html" title="Required Dependencies" class="chapter  " data-progress="6.5" style="left: 84.48275862068965%;"></a>
    
        <a href="../services/no_dependencies.html" title="No Backend Dependencies" class="chapter  " data-progress="6.6" style="left: 86.20689655172414%;"></a>
    
        <a href="../services/configuring_services.html" title="Configuring Services" class="chapter  " data-progress="6.7" style="left: 87.93103448275862%;"></a>
    
        <a href="../services/workbenches.html" title="Workbenches" class="chapter  " data-progress="6.8" style="left: 89.65517241379311%;"></a>
    
        <a href="../services/modularapp_services.html" title="Modular App Services" class="chapter  " data-progress="6.9" style="left: 91.37931034482759%;"></a>
    
        <a href="../aspects_services/README.html" title="Apps &amp; Aspects (again)" class="chapter  new-chapter" data-progress="7" style="left: 93.10344827586206%;"></a>
    
        <a href="../aspects_services/retrospective.html" title="Retrospective" class="chapter  " data-progress="7.1" style="left: 94.82758620689656%;"></a>
    
        <a href="../extras/README.html" title="Extras" class="chapter  new-chapter" data-progress="8" style="left: 96.55172413793103%;"></a>
    
        <a href="../reference/dev_setup.html" title="Suggested Dev Setup" class="chapter  " data-progress="9.1" style="left: 98.27586206896552%;"></a>
    
        <a href="../reference/faq_gotchas.html" title="FAQ &amp; Gotchas" class="chapter  " data-progress="9.2" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_50">
                    
                        <h1 id="exercise-messages-services">Exercise: Messages &amp; Services</h1>
<p>The following doesn&#39;t give you a step-by-step guide of what to do. It gives you
a number of individual pieces and you need to put them together in order to meet
the main feature requirement of the Messages Blade:</p>
<blockquote>
<p>Display message details that are received from the Chat Service</p>
</blockquote>
<p>The Messages Blade uses two services which will enable you to achieve this functionality:</p>
<ul>
<li>The Chat Service in order to receive messages</li>
<li>The EventHub in order to broadcast when a user ID is a message is selected</li>
</ul>
<p>We&#39;re nearly ready to start coding. But before we do let&#39;s do a little bit of setup.</p>
<h2 id="service-configuration">Service Configuration</h2>
<p>As we said, a nice team have put together some fake services to help us develop
our Blade&#39;s functionality. In order to configure the services you need to know
the require path to these implementations. Of course, we do. So, open up the configuration
file for the Workbench, which you&#39;ll find here:
<code>chat-bladeset/blades/messages/workbench/resources/aliases.xml</code>, and update it as
follows:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">aliases</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://schema.caplin.com/CaplinTrader/aliases"</span> <span class="hljs-attribute">useScenario</span>=<span class="hljs-value">"dev"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">alias</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"chat.service"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"chatservice.FakeChatService"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">aliases</span>&gt;</span>
</code></pre>
<p><em>Yes, it&#39;s XML</em>. What can we say! Anyway, we&#39;ve now actually configured:</p>
<ul>
<li><code>chat.service</code> to use a fake chat service implementation</li>
</ul>
<p>Now that the helper service is in place, we can get to work.</p>
<h2 id="get-the-existing-messages-from-the-chat-service">Get the Existing Messages from the Chat Service</h2>
<p>In order to get the Chat Service we first need to get the <code>ServiceRegistry</code>.
Update your <code>MessagesViewModel</code> accordingly e.g.</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> ServiceRegistry = <span class="hljs-built_in">require</span>( <span class="hljs-string">'br/ServiceRegistry'</span> );
</code></pre>
<p>To get the list of existing messages we need to retrieve the Chat Service
from the <code>ServiceRegistry</code>.</p>
<pre><code class="lang-js"><span class="hljs-keyword">this</span>._chatService = ServiceRegistry.getService( <span class="hljs-string">'chat.service'</span> );
</code></pre>
<p>The Chat Service exposes a <code>getMessages</code> function that takes a <code>listener</code>.</p>
<pre><code class="lang-js"><span class="hljs-keyword">this</span>._chatService.getMessages( listener );
</code></pre>
<p>The listener should implement two callback functions; <code>messagesRetrieved</code> and
<code>messageRetrievalFailed</code>. This can be achieved by passing in an object literal that defines these functions,
or by making the <code>MessagesViewModel</code> implement them and passing in <code>this</code> as the listener.</p>
<p>We&#39;ve found that although passing in listeners that have to implement contracts
(in the same way as services do) can be a bit more effort, it can result in
a much more robust solution. There are of course times where passing in a <code>function</code>
will be fine.</p>
<p>Here&#39;s how you make the <code>MessagesViewModel</code> fulfil the listener contract:</p>
<pre><code class="lang-js">MessagesViewModel.prototype.messagesRetrieved = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( messages )</span> {</span>
  <span class="hljs-comment">// add the messages to the `messages` View Model Array</span>
};

MessagesViewModel.prototype.messageRetrievalFailed = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  <span class="hljs-comment">// Something has gone wrong.</span>
};
</code></pre>
<p>From there you need to add the messages to the <code>messages</code> ObservableArray.</p>
<p>Once this is complete you should see a full list of existing messages in the
Workbench UI.</p>
<h5 id="hints-">Hints:</h5>
<p>You&#39;ll remember that when we were focusing on just building the <code>MessagesViewModel</code>
we added calls to <code>viewModel.addMessage</code> in the Workbench. Now we want to make
sure that the View Model is interacting with the Chat Service. So, in the Workbench
you can replace the calls to <code>viewModel.addMessage</code> with code that fetches
the Chat Service and calls <code>sendMessage</code> on it; this will store the messages so that
calls to <code>getMessages</code> return those messages.</p>
<p>The code looks something like this:</p>
<pre><code class="lang-js"><span class="hljs-keyword">this</span>._chatService = ServiceRegistry.getService( <span class="hljs-string">'chat.service'</span> );
<span class="hljs-keyword">this</span>._chatService.sendMessage( { userId: <span class="hljs-string">'testUser'</span>, text: <span class="hljs-string">'Word Up!'</span>, timestamp: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()  } );
</code></pre>
<h2 id="display-new-messages-from-the-chat-service">Display New Messages from the Chat Service</h2>
<p>The Chat Service emits a <code>new-message</code> event whenever a new message becomes available.
So, in order to be informed when that happens you need to bind to that event <code>on</code>
the Chat Service.</p>
<p><em>You should only bind to this event once you have the initial list of messages.
This avoids accidentally adding newer messages before the older ones, dealing with
duplicates and reordering. This can be done in <code>messagesRetrieved</code>.</em></p>
<p>An example of doing this, calling a function on the <code>MessagesViewModel</code> and maintaining
the <code>this</code> context is:</p>
<pre><code class="lang-js"><span class="hljs-comment">// do this within an instance function</span>
<span class="hljs-keyword">this</span>._chatService.on( <span class="hljs-string">'new-message'</span>, <span class="hljs-keyword">this</span>.handleNewMessage, <span class="hljs-keyword">this</span> );
</code></pre>
<h4 id="hints">Hints</h4>
<h5 id="a-chat-workbench-tool">A Chat Workbench Tool</h5>
<p>As part of developing the Chat Service one of the teams added a Chat Workbench Tool.
This can be added to the Workbench really easily. Just add the following to the end
of <code>chat-bladeset/blades/messages/index.html</code>:</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addChatTool</span><span class="hljs-params">(workbench )</span> {</span>
    <span class="hljs-keyword">var</span> ChatWorkbenchTool = <span class="hljs-built_in">require</span>( <span class="hljs-string">'chatservice/ChatWorkbenchTool'</span> );
    <span class="hljs-keyword">var</span> tool = <span class="hljs-keyword">new</span> ChatWorkbenchTool();
    workbench.addToLeftWing( tool, <span class="hljs-string">"Chatting"</span>, <span class="hljs-literal">false</span>);
}

addChatTool( workbench );
</code></pre>
<p>You can see the code required for this in <code>libs/chatservice/</code>...:</p>
<ul>
<li><code>src/chatservice/ChatWorkbenchTool.js</code> - Creates a UI component and adds to the Workbench</li>
<li><code>resources/workbench-chat-tool.html</code> - The HTML template</li>
</ul>
<p>Due to the Services architecture it really is that simple to add these developer tools.</p>
<h5 id="sending-messages-from-the-console">Sending Messages from the Console</h5>
<p>You can use the <code>sendMessage</code> function we used earlier to test sending messages
from the JavaScript console e.g.</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> chatService = ServiceRegistry.getService( <span class="hljs-string">'chat.service'</span> );
chatService.sendMessage(
  { userId: <span class="hljs-string">'testUser'</span>, text: <span class="hljs-string">'Awesome console message!'</span>, timestamp: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()  }
);
</code></pre>
<h2 id="broadcast-that-the-user-id-in-a-message-has-been-selected">Broadcast that the User ID in a Message has been Selected</h2>
<p>The team that is building the User Card Blade rely on being informed if a user
is selected. This is achieved by other components within ModularApp broadcasting
<code>user-selected</code> events on a <code>user</code> channel.</p>
<p>For the Messages Blade this means:</p>
<ul>
<li>Adding a click handler to the element in the Messages View with <code>class=&quot;message-user-id&quot;</code></li>
<li>Add a click handler function to the <code>MessagesViewModel</code> or the <code>MessageItemViewMode</code> -
see <a href="http://knockoutjs.com/documentation/binding-context.html" target="_blank">KnockoutJS binding context</a></li>
<li>Creating event data object with a <code>userId</code> property that identifies the user that was selected</li>
<li>Triggering a <code>user-selected</code> event on a <code>user</code> channel on the <code>EventHub</code></li>
</ul>
<p>The EventHub can be retrieved from the <code>ServiceRegistry</code> as follows:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> ServiceRegistry = <span class="hljs-built_in">require</span>( <span class="hljs-string">'br/ServiceRegistry'</span> );
<span class="hljs-keyword">this</span>._eventHub = ServiceRegistry.getService( <span class="hljs-string">'br.event-hub'</span> );
</code></pre>
<p>Channels can be retrieved from the EventHub:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> channel = <span class="hljs-keyword">this</span>._eventHub.channel( <span class="hljs-string">'user'</span> );
</code></pre>
<p>Events are triggered on the Channel:</p>
<pre><code class="lang-js">channel.trigger( <span class="hljs-string">'user-selected'</span>, { userId: <span class="hljs-string">'testUser'</span> } );
</code></pre>
<p>Over to you.</p>
<h4 id="hints">Hints</h4>
<p>No hints here. Any questions, please ask.</p>
<h2 id="testing-features">Testing Features</h2>
<p><em>Before we start, you need to copy the contents of <code>aliases.xml</code> from the Workbench
into <code>messages/tests/test-unit/js-test-driver/resources/aliases.xml</code>.</em></p>
<p>In the services overview we talked about how using MVVM and Services allows us to
test full features in isolation. In this part of the exercise we&#39;re going to do
exactly that. We&#39;ll demonstrate how to achieve two types of test:</p>
<ol>
<li>Create an instance of the View Model, interact with it, and ensure that
it results in the expected service interactions.</li>
<li>Force the Service to interact with the View Model and then verify the View Model state.</li>
</ol>
<p>This way we&#39;re testing how UI interactions result in service interactions and how
service events are reflected in UI state.</p>
<p>Let&#39;s start by creating a new file called <code>MessagesFeatureTest.js</code> in <code>messages/tests/test-unit/js-test-driver/tests/</code>
and update it to look as follows to add the Test Suite:</p>
<pre><code class="lang-js"><span class="hljs-pi">'use strict'</span>;

<span class="hljs-built_in">require</span>( <span class="hljs-string">'jasmine'</span> );

<span class="hljs-keyword">var</span> MessagesViewModel = <span class="hljs-built_in">require</span>( <span class="hljs-string">'modularapp/chat/messages/MessagesViewModel'</span>);
<span class="hljs-keyword">var</span> ServiceRegistry = <span class="hljs-built_in">require</span>( <span class="hljs-string">'br/ServiceRegistry'</span> );

describe( <span class="hljs-string">'The Messages'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

} );
</code></pre>
<p><em>Note: You could call this file MessagesSpecTest.js</em>.</p>
<p>The first thing to notice is that we&#39;re using Jasmine, and specifcially we&#39;re using
<a href="http://jasmine.github.io/1.3/introduction.html" target="_blank">Jasmine 1.3</a> as it ships with BRJS.</p>
<h3 id="testing-service-interactions">Testing Service Interactions</h3>
<p>As with anything in software it&#39;s possible to achieve the same thing in multiple ways.
For example, we can test service interactions by:</p>
<ul>
<li>Spying on interactions with a service that is already registered with the ServiceRegistry</li>
<li>Add functionality to Fake services that lets us check interactions</li>
<li>Replace the User Service in the <code>ServiceRegistry</code> with a Mock object</li>
</ul>
<p>Since we&#39;re using Jasmine, we&#39;ll use <a href="http://j.mp/PITNqK" target="_blank">Spies</a>, but we&#39;ll also demonstrate how the
Fake service, that was developed really to help our development within the
Workbench, is also useful here.</p>
<h3 id="testing-feature-service-interactions-using-spies">Testing Feature Service Interactions using Spies</h3>
<p>The only user interaction that takes place in the Messages Blade is the user
clicking on the User ID in a message. This results in an interaction with the
<code>EventHub</code> service.</p>
<p>Add the following spec to the <code>The Input</code> suite:</p>
<pre><code class="lang-js">describe( <span class="hljs-string">'The Messages'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

  it( <span class="hljs-string">'Should trigger a "user-selected" event on a user channel on the EventHub when a user is selected'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> eventHub = ServiceRegistry.getService( <span class="hljs-string">'br.event-hub'</span> );

    spyOn( eventHub, <span class="hljs-string">'channel'</span> ).andCallThrough();
    spyOn( userChannel, <span class="hljs-string">'trigger'</span> );

    <span class="hljs-keyword">var</span> testUserId = <span class="hljs-string">'testUser'</span>;

    <span class="hljs-comment">// TODO: Interact with View Model as if the user has selected a User Id</span>

    <span class="hljs-keyword">var</span> expectedEventData = {
      userId: testUserId
    };
    expect( eventHub.channel ).toHaveBeenCalledWith( <span class="hljs-string">'user'</span> );
    expect( userChannel.trigger ).toHaveBeenCalled( <span class="hljs-string">'user-selected'</span>, expectedEventData );

  } );

} );
</code></pre>
<p>The test above is nearly complete. You just need to interact with the <code>MessagesViewModel</code>
and simulate the user clicking the User Id. You&#39;ll need to make sure that the appropriate
data (the User Id) is passed to the click handler.</p>
<h4 id="hints">Hints</h4>
<ul>
<li>Use the <code>testUserId</code> value in the data that&#39;s passed to the click handler as
it&#39;s also used when creating the <code>expectedEventData</code> object used in the assertion</li>
</ul>
<h3 id="testing-feature-viewmodel-state-using-a-fake-service">Testing Feature ViewModel State using a Fake Service</h3>
<p>The next thing we want to do is see how services can impact the state of the View Model.
To do this we&#39;ll use the chat service - we&#39;ve seen that our <code>FakeChatService</code>
implementation triggers a <code>new-message</code> event when the <code>sendMessage</code> function is
called. We can use this knowledge to do the test.</p>
<p>Before we start, we need to remember that our implementation doesn&#39;t bind to the
<code>new-message</code> event until it&#39;s recieved the <code>getMessages</code> callback which is an
asynchronous call. Luckily our <code>FakeService</code> has a setting <code>FakeService.fakeAsync</code>
so that it doesn&#39;t make this callback truly asynchronously. This means we can ensure
that the <code>getMessages</code> response has been made before we call <code>sendMessage</code>.</p>
<p>Here&#39;s the test template - just fill in the blanks:</p>
<pre><code class="lang-js">it( <span class="hljs-string">'Should display new messages that are send via the Chat Service'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  <span class="hljs-comment">// Setup</span>
  <span class="hljs-keyword">var</span> chatService = ServiceRegistry.getService( <span class="hljs-string">'chat.service'</span> );
  chatService.fakeAsync = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> messagesViewModel = <span class="hljs-keyword">new</span> MessagesViewModel();
  <span class="hljs-keyword">var</span> message = { userId: <span class="hljs-string">'testUserId'</span>, text: <span class="hljs-string">'testUserText'</span>, timestamp: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() };

  <span class="hljs-comment">// Execute</span>
  <span class="hljs-comment">// TODO: send message using the Chat Service</span>

  <span class="hljs-comment">// Assert</span>
  <span class="hljs-keyword">var</span> firstMessage = messagesViewModel.messages()[ <span class="hljs-number">0</span> ];
  <span class="hljs-comment">// TODO: expect( ... );</span>
} );
</code></pre>
<h4 id="hints">Hints</h4>
<ul>
<li>An alternative to using <code>FakeChatService.fakeAsync = false;</code> is to use the very
handy <a href="http://j.mp/1nWvotX" target="_blank">jasmine.Clock</a>.</li>
<li>You should probably clear down the <code>FakeChatService.fakeAsync</code> after the test.
Otherwise future tests may be affected by this unexpected synchronous behaviour.</li>
</ul>
<h2 id="congrats-service-interaction-complete-">Congrats - Service Interaction Complete!</h2>
<p>Our Blade is now interacting with two services and we&#39;ve tested both UI through
to Services and Services through to the UI; full feature testing.</p>
<p>It&#39;s time to commit those changes and push them to github:</p>
<ul>
<li><code>git add chat-bladeset/blades/messages</code></li>
<li><code>git commit -m &#39;integrating messages blade with services&#39;</code></li>
<li><code>git pull origin master</code></li>
<li>Fix any merges - there shouldn&#39;t be any</li>
<li><code>git push origin master</code></li>
</ul>
<h2 id="where-next-">Where Next?</h2>
<p>See how the other teams in your company are getting on. Can you help them out?</p>
<p>Then, we&#39;ll see how our application looks.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../services/input_services.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../services/usercard_services.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
